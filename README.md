–ó–∞–≤–¥–∞–Ω–Ω—è 1
–ü–∞—Ä–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–∞—Å—Ç–æ –º–∞—é—Ç—å –¥—É–∂–µ –Ω–∏–∑—å–∫—É —î–Ω—Ç—Ä–æ–ø—ñ—é. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è –∫ —É –Ω–∞—Å 1 –ø–∞—Ä–æ–ª—å –≤ –∑–∞–≤–¥–∞–Ω–Ω—ñ.
–î—Ä—É–≥–∏–π —Ç–µ–∂ –∑ –Ω–µ–≤–∏—Å–æ–∫–æ—é —î–Ω—Ç—Ä–æ–ø—ñ—î—é. –ó –≤–∏—Å–æ–∫–æ—é —î–Ω—Ç—Ä–æ–ø—ñ—î—é –≤–∏–≥–ª—è–¥–∞—î 4-–π –ø–∞—Ä–æ–ª—å.
–í–∏–±–∏—Ä–∞—é –∞–ª–≥–æ—Ä–∏—Ç–º —Ö—î—à—É–≤–∞–Ω—è scrypt. —Ü–µ –ø–∞–º‚Äô—è—Ç—î—î–º–Ω–∏–π PBKDF, —è–∫–∏–π –ø—ñ–¥—ñ–π–¥–µ –¥–ª—è –≤—Å—ñ—Ö 4-—Ö —Ä—ñ–∑–Ω–æ—ó —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –ø–∞—Ä–æ–ª—ñ–≤.
–ê–ª–≥–æ—Ä–∏—Ç–º scrypt –º–∞—î –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø—ñ–¥—Å—Ç—Ä–æ–π–∫–∏, —Ç–æ–º—É –¥–ª—è –≤–µ–±-–ª–æ–≥—ñ–Ω—ñ–≤, —Ö–æ—á–∞ —Ü–µ –π –ø–∞–º‚Äô—è—Ç—î—î–º–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∞–ª–µ –∂ –º–æ–∂–Ω–∞ –ø—ñ–¥–±—Ä–∞—Ç–∏ –±–∞–ª–∞–Ω—Å –±–µ–∑–ø–µ–∫–∏/–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.
ùëÅ = 2**14 = 16384
ùëü = 8
ùëù = 1
salt = 16 –±–∞–π—Ç –≤–∏–ø–∞–¥–∫–æ–≤–æ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
–¥–æ–≤–∂–∏–Ω–∞ –∫–ª—é—á–∞ (dklen) = 32 –±–∞–π—Ç–∏ (256 –±—ñ—Ç).
–¢–æ–¥—ñ —Ñ–æ—Ä–º–∞—Ç —Ö–µ—à—É:
$scrypt$ln=<log2(N)>,r=<r>,p=<p>$<base64(salt)>$<base64(hash)>
–û—Ç—Ä–∏–º–∞–Ω—ñ —Ö–µ—à—ñ –≤ —Ñ–∞–π–ª—ñ password_hashes.txt –≤ —Ä–µ–ø–æ–∑—Ç–∏—Ä—ñ—ó



–ó–∞–≤–¥–∞–Ω–Ω—è 2
1. –ö–æ–¥ –¥–ª—è –≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è —ñ–º—ñ—Ç–æ–≤—Å—Ç–∞–≤–∫–∏ (MAC) - generate_mac.py
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏—Å—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ : hashlib, hmac.

2. –û—Ç—Ä–∏–º–∞–Ω–∞ —ñ–º—ñ—Ç–æ–≤—Å—Ç–∞–≤–∫–∞ –≤ —Ñ–∞–π–ª—ñ: mac_tag_hex.txt
–ê–±–æ: 
690f0be5cf3cfd9c93fc17268ea3dd89c0d2d230b29f0f66a56f2322e310d0ad

3. –ß–æ–º—É —Å–∞–º–µ  HMAC-SHA-256?
–¶–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —ñ –∫—Ä–∏–ø—Ç–æ—Å—Ç—ñ–π–∫–∏–π –∫–æ–¥ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, —Å—Ç—ñ–π–∫–∏–π –¥–æ length-extension –¥–ª—è —Å—ñ–º–µ–π—Å—Ç–≤–∞ Merkle‚ÄìDamg√•rd —ñ —à–∏—Ä–æ–∫–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞–º–∏.
–î–∞—î 256-–±—ñ—Ç–Ω–∏–π —Ç–µ–≥, —á–æ–≥–æ –±—ñ–ª—å—à –Ω—ñ–∂ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è –≤–µ–±/—Å–µ—Ä–≤—ñ—Å–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤.


–ó–∞–≤–¥–∞–Ω–Ω—è 3

–ö–æ–¥ derive_key.py ‚Äî —Ñ—É–Ω–∫—Ü—ñ—è derive_key(username, password) –ø–æ–≤–µ—Ä—Ç–∞—î 16 –±–∞–π—Ç (AES-128).
–ú–µ—Ç–∞–¥–∞–Ω—ñ (—É–Ω—ñ–∫–∞–ª—å–Ω–∞ salt) –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É users_kdf.json.

–£–Ω—ñ–∫–∞–ª—å–Ω–∞ salt –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞–ø–æ–±—ñ–≥–∞—î —Ä–∞–π–¥—É–∂–Ω–∏–º —Ç–∞–±–ª–∏—Ü—è–º —ñ –∫–æ–ª—ñ–∑—ñ—è–º –º—ñ–∂ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ –ø–∞—Ä–æ–ª—è–º–∏.

–ê–ª–≥–æ—Ä–∏—Ç–º KDF: scrypt ‚Äî –ø–∞–º‚Äô—è—Ç—î—î–º–Ω–∏–π KDF –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: N=2^14, r=8, p=1, dklen=16.
–ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–∞–ª—ñ–±—Ä—É—é—Ç—å—Å—è –ø—ñ–¥ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞. 
Scrypt –¥–æ—Å—Ç—É–ø–Ω–∏–π —É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ–π –±—ñ–±–ª—ñ–æ—Ç–µ—Ü—ñ Python (hashlib.scrypt), —â–æ —Å–ø—Ä–æ—â—É—î –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω—ñ—Å—Ç—å —ñ –¥–µ–ø–ª–æ–π –±–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π.

python derive_key.py <username> <password>
(venv) dimm@dimm-VMware-Virtual-Platform:~/HomeWork-5$ python derive_key.py dimmka imm29np!
61c62fba4201987dd8e9c31a34f346c7
